{"version":3,"sources":["../../../src/builtins/mobile/index.js"],"names":["path","require","fs","localConfig","steps","packageConfig","getTemplatePath","copyFileFromTemplate_","deleteLines_","module","exports","app","options","appNameLowerCase","appName","toLowerCase","targetPath","join","workingPath","appDir","cmd","cwd","existsSync","runCommand_","disablePackageLock","unlink","templatePath","appMode","removeFiles_","copyFilesFromTemplate_","fileMainActivity","__dirname","log","createOptionalFiles_","updatePackageJson_","config","addPackages","addConfig","addNpmScripts","npmInstall_","iosProject"],"mappings":"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","sourcesContent":["const path = require(\"path\");\nconst { fs } = require(\"@genx/sys\");\nconst localConfig = require(\"./config\");\nconst { steps, packageConfig } = require(\"../..\");\nconst getTemplatePath = require(\"../../utils/getTemplatePath\");\nconst copyFileFromTemplate_ = require(\"../../utils/copyFileFromTemplate_\");\nconst deleteLines_ = require(\"../../utils/deleteLines_\");\n\nmodule.exports = async (app, options) => {\n    const appNameLowerCase = options.appName.toLowerCase();\n    options = {\n        ...localConfig,\n        ...options,\n        appNameLowerCase,\n    };\n\n    const targetPath = path.join(options.workingPath, options.appDir);\n    let cmd = `npx react-native init ${options.appName} --npm`;\n    let cwd;\n\n    if (!fs.existsSync(targetPath)) {\n        cwd = options.workingPath;\n        cmd += ` --directory ${options.appDir}`;\n    } else {\n        cwd = targetPath;\n        cmd += ` --directory .`;\n    }\n\n    await steps.runCommand_(app, cwd, cmd, true);\n\n    if (options.disablePackageLock) {\n        await fs.unlink(path.join(targetPath, \"package-lock.json\"));\n    }\n\n    const templatePath = getTemplatePath(options.appMode);\n\n    await steps.removeFiles_(app, targetPath, [\"app.json\", \".prettierrc.js\", \"App.js\", \"index.js\"]);\n\n    await steps.copyFilesFromTemplate_(app, templatePath, targetPath, options);\n\n    const fileMainActivity = `android/app/src/main/java/com/${appNameLowerCase}/MainActivity.java`;\n    await copyFileFromTemplate_(\n        path.join(__dirname, \"changes/MainActivity.java.tpl\"),\n        path.join(targetPath, fileMainActivity),\n        options\n    );\n    app.log(\"info\", `Updated ${fileMainActivity}`);\n\n    await steps.createOptionalFiles_(app, targetPath, options);\n\n    await steps.updatePackageJson_(app, targetPath, (config) => {\n        packageConfig.addPackages(config, options);\n        packageConfig.addConfig(config, options);\n        packageConfig.addNpmScripts(config, options);\n    });\n\n    await steps.npmInstall_(app, targetPath, options);\n\n    await steps.runCommand_(app, targetPath, \"npm run pod\");\n    await steps.runCommand_(app, targetPath, \"npm run link\");\n\n    const iosProject = `ios/${options.appName}.xcodeproj/project.pbxproj`;\n    await deleteLines_(path.join(targetPath, iosProject), [\n        \"/* AntDesign.ttf in Resources */\",\n        \"/* Entypo.ttf in Resources */\",\n        \"/* EvilIcons.ttf in Resources */\",\n        \"/* Feather.ttf in Resources */\",\n        \"/* FontAwesome.ttf in Resources */\",\n        \"/* FontAwesome5_Brands.ttf in Resources */\",\n        \"/* FontAwesome5_Regular.ttf in Resources */\",\n        \"/* FontAwesome5_Solid.ttf in Resources */\",\n        \"/* Fontisto.ttf in Resources */\",\n        \"/* Foundation.ttf in Resources */\",\n        \"/* Ionicons.ttf in Resources */\",\n        \"/* MaterialCommunityIcons.ttf in Resources */\",\n        \"/* MaterialIcons.ttf in Resources */\",\n        \"/* Octicons.ttf in Resources */\",\n        \"/* SimpleLineIcons.ttf in Resources */\",\n        \"/* Zocial.ttf in Resources */\",\n    ]);\n    app.log(\"info\", `Patched ${iosProject} for work around \"react-native-vector-icons\" duplicate resources issue.`);\n};\n"],"file":"index.js"}