{"version":3,"sources":["../../../src/builtins/mobile/index.js"],"names":["path","require","fs","localConfig","steps","packageConfig","getTemplatePath","copyFileFromTemplate_","module","exports","app","options","appNameLowerCase","appName","toLowerCase","targetPath","join","workingPath","appDir","cmd","cwd","existsSync","runCommand_","disablePackageLock","unlink","templatePath","appMode","removeFiles_","copyFilesFromTemplate_","fileMainActivity","__dirname","log","createOptionalFiles_","updatePackageJson_","config","addPackages","addConfig","addNpmScripts","npmInstall_"],"mappings":"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","sourcesContent":["const path = require(\"path\");\nconst { fs } = require(\"@genx/sys\");\nconst localConfig = require(\"./config\");\nconst { steps, packageConfig } = require(\"../..\");\nconst getTemplatePath = require(\"../../utils/getTemplatePath\");\nconst copyFileFromTemplate_ = require(\"../../utils/copyFileFromTemplate_\");\n\nmodule.exports = async (app, options) => {\n    const appNameLowerCase = options.appName.toLowerCase();\n    options = {\n        ...localConfig,\n        ...options,\n        appNameLowerCase,\n    };\n\n    const targetPath = path.join(options.workingPath, options.appDir);\n    let cmd = `npx react-native init ${options.appName} --npm`;\n    let cwd;\n\n    if (!fs.existsSync(targetPath)) {\n        cwd = options.workingPath;\n        cmd += ` --directory ${options.appDir}`;\n    } else {\n        cwd = targetPath;\n        cmd += ` --directory .`;\n    }\n\n    await steps.runCommand_(app, cwd, cmd, true);\n\n    if (options.disablePackageLock) {\n        await fs.unlink(path.join(targetPath, \"package-lock.json\"));\n    }\n\n    const templatePath = getTemplatePath(options.appMode);\n\n    await steps.removeFiles_(app, targetPath, [\".prettierrc.js\", \"App.js\", \"index.js\"]);\n\n    await steps.copyFilesFromTemplate_(app, templatePath, targetPath, options);\n\n    const fileMainActivity = `android/app/src/main/java/com/${appNameLowerCase}/MainActivity.java`;\n    await copyFileFromTemplate_(\n        path.join(__dirname, \"changes/MainActivity.java.tpl\"),\n        path.join(targetPath, fileMainActivity),\n        options\n    );\n    app.log('info', `Updated ${fileMainActivity}`);\n\n    await steps.createOptionalFiles_(app, targetPath, options);\n\n    await steps.updatePackageJson_(app, targetPath, (config) => {\n        packageConfig.addPackages(config, options);\n        packageConfig.addConfig(config, options);\n        packageConfig.addNpmScripts(config, options);\n    });\n\n    await steps.npmInstall_(app, targetPath, options);\n    \n    await steps.runCommand_(app, targetPath, 'npm run pod');\n    await steps.runCommand_(app, targetPath, 'npm run link');\n};\n"],"file":"index.js"}